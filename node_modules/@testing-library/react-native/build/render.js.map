{"version":3,"sources":["../src/render.tsx"],"names":["render","component","wrapper","Wrapper","createNodeMock","wrap","innerElement","renderer","renderWithAct","undefined","update","updateWithAct","instance","root","unmount","container","rerender","toJSON","debug","options","TestRenderer","create","debugImpl","message","json","shallow"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAUA;AACA;AACA;AACA;AACe,SAASA,MAAT,CACbC,SADa,EAEb;AAAEC,EAAAA,OAAO,EAAEC,OAAX;AAAoBC,EAAAA;AAApB,IAAgD,EAFnC,EAGb;AACA,QAAMC,IAAI,GAAIC,YAAD,IACXH,OAAO,gBAAG,oBAAC,OAAD,QAAUG,YAAV,CAAH,GAAuCA,YADhD;;AAGA,QAAMC,QAAQ,GAAGC,aAAa,CAC5BH,IAAI,CAACJ,SAAD,CADwB,EAE5BG,cAAc,GAAG;AAAEA,IAAAA;AAAF,GAAH,GAAwBK,SAFV,CAA9B;AAIA,QAAMC,MAAM,GAAGC,aAAa,CAACJ,QAAD,EAAWF,IAAX,CAA5B;AACA,QAAMO,QAAQ,GAAGL,QAAQ,CAACM,IAA1B;;AACA,QAAMC,OAAO,GAAG,MAAM;AACpB,sBAAI,MAAM;AACRP,MAAAA,QAAQ,CAACO,OAAT;AACD,KAFD;AAGD,GAJD;;AAMA,kCAAkBA,OAAlB;AAEA,SAAO,EACL,GAAG,wBAASF,QAAT,CADE;AAEL,OAAG,4BAAWA,QAAX,CAFE;AAGL,OAAG,0BAAUA,QAAV,CAHE;AAIL,OAAG,sBAAQA,QAAR,CAJE;AAKLF,IAAAA,MALK;AAMLI,IAAAA,OANK;AAOLC,IAAAA,SAAS,EAAEH,QAPN;AAQLI,IAAAA,QAAQ,EAAEN,MARL;AAQa;AAClBO,IAAAA,MAAM,EAAEV,QAAQ,CAACU,MATZ;AAULC,IAAAA,KAAK,EAAEA,KAAK,CAACN,QAAD,EAAWL,QAAX;AAVP,GAAP;AAYD;;AAED,SAASC,aAAT,CACEP,SADF,EAEEkB,OAFF,EAGqB;AACnB,MAAIZ,QAAJ;AAEA,oBAAI,MAAM;AACRA,IAAAA,QAAQ,GAAGa,2BAAaC,MAAb,CAAoBpB,SAApB,EAA+BkB,OAA/B,CAAX;AACD,GAFD,EAHmB,CAOnB;;AACA,SAAOZ,QAAP;AACD;;AAED,SAASI,aAAT,CACEJ,QADF,EAEEF,IAFF,EAGE;AACA,SAAO,UAAUJ,SAAV,EAAyC;AAC9C,sBAAI,MAAM;AACRM,MAAAA,QAAQ,CAACG,MAAT,CAAgBL,IAAI,CAACJ,SAAD,CAApB;AACD,KAFD;AAGD,GAJD;AAKD;;AAOD,SAASiB,KAAT,CACEN,QADF,EAEEL,QAFF,EAGiB;AACf,WAASe,SAAT,CAAmBC,OAAnB,EAAqC;AACnC,UAAMC,IAAI,GAAGjB,QAAQ,CAACU,MAAT,EAAb;;AACA,QAAIO,IAAJ,EAAU;AACR,aAAO,wBAAUA,IAAV,EAAgBD,OAAhB,CAAP;AACD;AACF;;AACDD,EAAAA,SAAS,CAACG,OAAV,GAAqBF,OAAD,IAAsB,2BAAaX,QAAb,EAAuBW,OAAvB,CAA1C;;AACA,SAAOD,SAAP;AACD","sourcesContent":["import TestRenderer from 'react-test-renderer';\nimport type { ReactTestInstance, ReactTestRenderer } from 'react-test-renderer';\nimport * as React from 'react';\nimport act from './act';\nimport { addToCleanupQueue } from './cleanup';\nimport { getByAPI } from './helpers/getByAPI';\nimport { queryByAPI } from './helpers/queryByAPI';\nimport { findByAPI } from './helpers/findByAPI';\nimport { a11yAPI } from './helpers/a11yAPI';\nimport debugShallow from './helpers/debugShallow';\nimport debugDeep from './helpers/debugDeep';\n\ntype Options = {\n  wrapper?: React.ComponentType<any>;\n  createNodeMock?: (element: React.ReactElement) => any;\n};\ntype TestRendererOptions = {\n  createNodeMock: (element: React.ReactElement) => any;\n};\n\n/**\n * Renders test component deeply using react-test-renderer and exposes helpers\n * to assert on the output.\n */\nexport default function render<T>(\n  component: React.ReactElement<T>,\n  { wrapper: Wrapper, createNodeMock }: Options = {}\n) {\n  const wrap = (innerElement: React.ReactElement) =>\n    Wrapper ? <Wrapper>{innerElement}</Wrapper> : innerElement;\n\n  const renderer = renderWithAct(\n    wrap(component),\n    createNodeMock ? { createNodeMock } : undefined\n  );\n  const update = updateWithAct(renderer, wrap);\n  const instance = renderer.root;\n  const unmount = () => {\n    act(() => {\n      renderer.unmount();\n    });\n  };\n\n  addToCleanupQueue(unmount);\n\n  return {\n    ...getByAPI(instance),\n    ...queryByAPI(instance),\n    ...findByAPI(instance),\n    ...a11yAPI(instance),\n    update,\n    unmount,\n    container: instance,\n    rerender: update, // alias for `update`\n    toJSON: renderer.toJSON,\n    debug: debug(instance, renderer),\n  };\n}\n\nfunction renderWithAct(\n  component: React.ReactElement,\n  options?: TestRendererOptions\n): ReactTestRenderer {\n  let renderer: ReactTestRenderer;\n\n  act(() => {\n    renderer = TestRenderer.create(component, options);\n  });\n\n  // @ts-ignore act is sync, so renderer is always initialised here\n  return renderer;\n}\n\nfunction updateWithAct(\n  renderer: ReactTestRenderer,\n  wrap: (innerElement: React.ReactElement) => React.ReactElement\n) {\n  return function (component: React.ReactElement) {\n    act(() => {\n      renderer.update(wrap(component));\n    });\n  };\n}\n\ninterface DebugFunction {\n  (message?: string): void;\n  shallow: (message?: string) => void;\n}\n\nfunction debug(\n  instance: ReactTestInstance,\n  renderer: ReactTestRenderer\n): DebugFunction {\n  function debugImpl(message?: string) {\n    const json = renderer.toJSON();\n    if (json) {\n      return debugDeep(json, message);\n    }\n  }\n  debugImpl.shallow = (message?: string) => debugShallow(instance, message);\n  return debugImpl;\n}\n"],"file":"render.js"}